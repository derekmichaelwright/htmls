---
title: "Genetically Engineered Crop Production"
subtitle: "Graphs of GE crop production using ISAAA data"
summary:  "Graphs of GE crop production using ISAAA data"
author: "Derek Michael Wright <wrightmderek@gmail.com> [www.dblogr.com/](https://dblogr.netlify.com/)"
date: "2020-03-01"
categories: [ "agData" ]
tags: [ "agData", "GE Crops" ]
image:
  preview_only: true
links: 
  - icon_pack: fas
    icon: chart-line
    name: All Graphs
    url: agdata_graphs/ge_crops
  - icon: file-code
    icon_pack: far
    name: HTML
    url: https://derekmichaelwright.github.io/htmls/agdata/ge_crops.html
  - icon: file-pdf
    icon_pack: far
    name: PDF (Save/Print)
    url: agdata_pdfs/ge_crops.pdf
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
```

---

```{r}
# devtools::install_github("derekmichaelwright/agData")
library(agData) # Loads: tidyverse, ggpubr, ggbeeswarm, ggrepel
```

\pagebreak

# Global Hectares

## Global Area

```{r}
# Prep data
xx <- agData_ISAAA_Area %>% filter(Measurement == "Area")
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value / 1000000)) +
  geom_bar(stat = "identity", alpha = 0.5) +
  geom_line(color = "darkred", size = 2) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-0.5)) +
  theme_agData() +
  labs(title = "Global Area of GE Crops", 
       y = "Million Hectares", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_01.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_01.png", mp, width = 6, height = 4)
```

![](ge_crops_01.png)

\pagebreak

## Year to Year Change

```{r}
# Prep data
xx <- agData_ISAAA_Area %>% 
  mutate(Value = ifelse(Measurement != "Percent Change", Value / 1000000, Value),
         Unit  = ifelse(Measurement != "Percent Change", paste("Million", Unit), Unit),
         Text  = ifelse((Measurement == "Percent Change" & Year %in% 1997:1999), Value, NA),
         Value = ifelse((Measurement == "Percent Change" & Year %in% 1997:1999), NA, Value))
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value)) + 
  geom_bar(stat = "identity", alpha = 0.7, color = "Black", fill = "darkred") + 
  geom_text(aes(label = Text), y = 0, angle = 270, hjust = 1, vjust = 0.5 ) + 
  facet_grid(Measurement + Unit ~ ., scales = "free_y", switch = "y") +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.4, max(xx$Year)-0.4)) +
  theme_agData(strip.placement = "outside") +
  labs(title = "Global Area of GE Crops", 
       y = NULL, x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_02.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_02.png", mp, width = 6, height = 4)
```

![](ge_crops_02.png)

\pagebreak

# Devloping vs Developed Countries

## Area

```{r}
# Prep data
xx <- agData_ISAAA_DVDDVG %>% filter(Unit == "Hectares")
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value / 1000000, color = Area)) + 
  geom_line(size = 2) + 
  scale_color_manual(values = c("darkgreen","darkred")) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-0.5)) +
  theme_agData(legend.position = "bottom") +
  labs(title = "Global Area of GE Crops", 
       y = "Million Hectares", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA/")
ggsave("ge_crops_03.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_03.png", mp, width = 6, height = 4)
ggsave("featured.png", mp, width = 6, height = 4)
```

![](ge_crops_03.png)

\pagebreak

## Percentage

```{r}
# Prep data
xx <- agData_ISAAA_DVDDVG %>% filter(Unit == "Percent")
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value, color = Area)) + 
  geom_line(size = 2) + 
  scale_color_manual(values = c("darkgreen","darkred")) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-0.5)) +
  theme_agData(legend.position = "bottom") +
  labs(title = "Global Area of GE Crops", 
       y = "Percent", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_04.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_04.png", mp, width = 6, height = 4)
```

![](ge_crops_04.png)

\pagebreak

# Crops

## Area

```{r}
# Prep Data
xx <- agData_ISAAA_Crop %>% 
  filter(Measurement == "Area", 
         Crop %in% c("Soybean", "Maize", "Cotton", "Canola"))
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value / 1000000, color = Crop)) +
  geom_line(size = 2) +
  scale_color_manual(values = agData_Colors) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-0.5)) +
  theme_agData(legend.position = "bottom") +
  labs(title = "Global Area of GE Crops", 
       y = "Million Hectares", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_05.png", mp, width = 6, height = 4)
```

```{r echo = F,}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_05.png", mp, width = 6, height = 4)
```

![](ge_crops_05.png)

\pagebreak

## Percentage

```{r}
# Prep Data
xx <- agData_ISAAA_Crop %>% 
  filter(Measurement == "Percent of GE Area", 
         Crop %in% c("Soybean", "Maize", "Cotton", "Canola"))
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value, color = Crop)) +
  geom_line(size = 2) +
  scale_color_manual(values = agData_Colors) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-0.5)) +
  theme_agData(legend.position = "bottom") +
  labs(title = "Percent of GE Area by Crop", y = "Percent", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_06.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_06.png", mp, width = 6, height = 4)
```

![](ge_crops_06.png)

\pagebreak

## Year to Year Change

```{r}
# Prep Data
xx <- agData_ISAAA_Crop %>% 
  filter(Measurement == "Area Change", 
         Crop %in% c("Soybean", "Maize", "Cotton", "Canola"))
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value / 1000000, fill = Crop)) +
  geom_bar(stat = "identity") +
  facet_grid(Crop ~ ., scales = "free_y") +
  scale_fill_manual(values = agData_Colors) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.4, max(xx$Year)-0.4)) +
  theme_agData(legend.position = "none") +
  labs(title = "Year to Year Change in GE Crop Hectares", 
       y = "Million Hectares", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_07.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_07.png", mp, width = 6, height = 4)
```

![](ge_crops_07.png)

\pagebreak

## Year to Year Percentage Change

```{r}
# Prep Data
xx <- agData_ISAAA_Crop %>% 
  filter(Measurement == "Percent Change", Year > 1997,
         Crop %in% c("Soybean", "Maize", "Cotton", "Canola"))
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value, fill = Crop)) +
  geom_bar(stat = "identity") +
  facet_grid(Crop ~ ., scales = "free_y") +
  scale_fill_manual(values = agData_Colors) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.3, max(xx$Year)-0.3)) +
  theme_agData(legend.position = "none") +
  labs(title = "Percent change of GE Crops Year to Year", 
       y = "Percent", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_08.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_08.png", mp, width = 6, height = 4)
```

![](ge_crops_08.png)

\pagebreak

# Adoption of Genetically Engineered Crops

## Percentage

```{r}
# Prep Data
xx <- agData_ISAAA_CropPercent %>% 
  filter(Measurement == "Percent", Crop != "Others")
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value, color = Crop)) +
  geom_line(size = 2) +
  scale_color_manual(values = agData_Colors) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-0.5)) +
  theme_agData(legend.position = "bottom") +
  labs(title = "Adoption of GE Crops", y = "Percent", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_09.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_09.png", mp, width = 6, height = 4)
ggsave("../../home/gallery/gallery/06_ge_crops_09.png", mp, width = 6, height = 4)
```

![](ge_crops_09.png)

\pagebreak

## Area

```{r}
# Prep Data
xx <- agData_ISAAA_CropPercent %>% 
  filter(Crop != "Others", Measurement != "Percent") 
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value / 1000000, color = Measurement)) +
  geom_line(size = 2) +
  facet_wrap(Crop ~ ., ncol= 2, scales = "free_y") +
  scale_color_manual(values = agData_Colors) +
  scale_x_continuous(breaks = c(2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  theme_agData(legend.position = "bottom") +
  labs(title = "Adoption of GE Crops", y = "Million Hectares", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_10.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_10.png", mp, width = 6, height = 4)
```

![](ge_crops_10.png)

\pagebreak

## Top Countries

```{r}
# Prep Data
xx<- agData_ISAAA_Country %>% filter(Measurement == "Area")
yy <- xx %>% filter(Value > 3000000) %>% pull(Area) %>% unique()
xx <- xx %>% filter(Area %in% yy) %>%
  arrange(desc(Value)) %>%
  mutate(Area = factor(Area, levels = unique(.$Area)),
         Value = Value / 1000000)
xE <- xx %>% top_n(1, Year) %>% pull(Value) %>% round(1)
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value, color = Area)) + 
  geom_line(size = 1.5) + 
  scale_color_manual(values = agData_Colors) +
  scale_y_continuous(breaks = seq(0, 80, by = 10), 
                     sec.axis = sec_axis(~ ., breaks = xE[1:6])) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-1)) +
  theme_agData() +
  labs(title = "Area of GE Crop by Country", y = "Million Hectares", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_11.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_11.png", mp, width = 6, height = 4)
ggsave("../../home/gallery/gallery/06_ge_crops_11.png", mp, width = 6, height = 4)
```

![](ge_crops_11.png)

\pagebreak

## Every Country  

```{r}
# Prep Data
xx<- agData_ISAAA_Country %>%
  arrange(desc(Value)) %>%
  mutate(Area = factor(Area, levels = unique(.$Area)))
# Plot
mp <- ggplot(xx, aes(x = Year, y = Value / 1000000)) + 
  geom_bar(stat = "identity") +
  facet_wrap(Area ~ ., scales = "free_y", ncol = 10) +
  theme_agData() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
  labs(title = "Area of GE Crop by Country", y = "Million Hectares", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_12.png", mp, width = 20, height = 8)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_12.png", mp, width = 15, height = 15)
```

![](ge_crops_12.png)

\pagebreak

# Value of GE Seed

```{r}
# Plot 
mp <- ggplot(agData_ISAAA_Value, aes(x = Year, y = Value)) +
  geom_bar(stat = "identity", alpha = 0.5) +
  geom_line(color = "darkred", size = 2) +
  scale_x_continuous(breaks = c(1996, 2000, 2005, 2010, 2015),
                     minor_breaks = seq(1996, 2020, by = 1)) +
  coord_cartesian(xlim = c(min(xx$Year)+0.5, max(xx$Year)-0.5)) +
  theme_agData() +
  labs(title = "Value of GE Seed", y = "Billion USD", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ISAAA")
ggsave("ge_crops_13.png", mp, width = 6, height = 4)
```

```{r echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_13.png", mp, width = 6, height = 4)
```

![](ge_crops_13.png)

\pagebreak

# Regulations of New Breeding Technologies

```{r eval = F, echo = F}
# Prep data
xx <- agData_NBT_Limits %>% 
  mutate(Limiting.Factor = as.character(Limiting.Factor),
         PercentLabel = paste(Percent, "%"))
xx$Limiting.Factor[9] <- "Inadequate infrastructure"
xx <- xx %>% 
  mutate(Limiting.Factor = factor(Limiting.Factor, levels = rev(Limiting.Factor)))
# Plot
mp <- ggplot(xx, aes(x = Limiting.Factor, y = Percent, label = PercentLabel)) + 
  geom_bar(stat = "identity", alpha = 0.8, color = "black", fill = "darkred") + 
  geom_text(color = "white", nudge_y = -1.5) + 
  theme_agData() + 
  coord_flip() +
  labs(title = "Regulatory Barriers for NBTs", x = NULL,
       caption = "\xa9 www.dblogr.com/  |  Data: ?") 
ggsave("ge_crops_14.png", mp, width = 6, height = 4)
```

```{r eval = F, echo = F}
ggsave("../../agdata_graphs/ge_crops/gallery/gallery/ge_crops_14.png", mp, width = 6, height = 4)
```


```{r echo = F, eval = F}
xx <- agData_ISAAA_CropPercent %>% filter(Crop == "Others")
ggplot(xx, aes(x = Year, y = Value, color = Crop)) +
  geom_line(size = 2) +
  facet_grid(.~) +
  theme_agData() +
  scale_color_manual(values = agData_Colors)
```