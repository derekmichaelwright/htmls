---
title: "Nitrogen Use Efficiency"
subtitle: "Graphs of nitrogen use efficiency (NUE) using data from FAO"
summary:  "Graphs of nitrogen use efficiency (NUE) using data from FAO"
author: "Derek Michael Wright <wrightmderek@gmail.com> [www.dblogr.com/](https://dblogr.netlify.com/)"
date: "2020-03-02"
categories: [ "agData" ]
tags: [ "agData", "Fertilizers" ]
image:
  preview_only: true
links: 
  - icon_pack: fas
    icon: chart-line
    name: All Graphs
    url: agdata_graphs/nue
  - icon_pack: far
    icon: file-code
    name: HTML
    url: https://derekmichaelwright.github.io/htmls/agdata/nue.html
  - icon_pack: far
    icon: file-pdf
    name: PDF (Save/Print)
    url: agdata_pdfs/nue.pdf
---



<hr />
<pre class="r"><code># devtools::install_github(&quot;derekmichaelwright/agData&quot;)
library(agData) # Loads: tidyverse, ggpubr, ggbeeswarm, ggrepel</code></pre>
<p>Formula 1: <span class="math inline">\(NUE=N_{in Seed}/N_{Available}\)</span></p>
<p>Formula 2: <span class="math inline">\(NUE=Yield/N_{Available}\)</span></p>
<div style="page-break-after: always;"></div>
<div id="prepare-data" class="section level1">
<h1>Prepare data</h1>
<pre class="r"><code>x1 &lt;- agData_FAO_Fertilizers %&gt;% 
  filter(Item %in% c(&quot;Nitrogenous fertilizers&quot;, &quot;Nutrient nitrogen N (total)&quot;),
         Measurement == &quot;Agricultural Use&quot;) %&gt;% select(Area, Year, TonnesN = Value)
x2 &lt;- agData_FAO_Crops2 %&gt;% 
  filter(Crop == &quot;Cereals, Total&quot;, Measurement != &quot;Production&quot;) %&gt;%
  select(-Unit) %&gt;% spread(Measurement, Value) %&gt;%
  select(Area, Year, Yield, `Area harvested`)
x3 &lt;- agData_FAO_LandUse %&gt;% filter(Item == &quot;Arable land&quot;) %&gt;% 
  mutate(Value = Value * 1000) %&gt;% select(Area, Year, AgArea=Value)
xx &lt;- left_join(x1, x2, by = c(&quot;Area&quot;,&quot;Year&quot;)) %&gt;%
  left_join(x3, by = c(&quot;Area&quot;,&quot;Year&quot;)) %&gt;%
  mutate(Area_P = `Area harvested` / AgArea,
         N_per_h = (TonnesN * Area_P) / `Area harvested`,
         NUE = Yield / N_per_h)</code></pre>
</div>
<div id="global-nue" class="section level1">
<h1>Global NUE</h1>
<pre class="r"><code>xi &lt;- xx %&gt;% filter(Area == &quot;World&quot;)
mp &lt;- ggplot(xi, aes(x = Year, y = NUE, color = Area)) + 
  geom_line() + 
  facet_wrap(Area ~ .) +
  scale_x_continuous(breaks = seq(1960,2020, by = 10)) +
  theme_agData(legend.position = &quot;none&quot;) +
  labs(x = NULL, caption = &quot;\xa9 www.dblogr.com/  |  Data: FAOSTAT&quot;)
ggsave(&quot;nue_01.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_01.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="countries" class="section level1">
<h1>Countries</h1>
<pre class="r"><code>areas &lt;- c(&quot;Australia&quot;, &quot;Canada&quot;, &quot;China&quot;, &quot;Germany&quot;, &quot;India&quot;, &quot;France&quot;)
xi &lt;- xx %&gt;% filter(Area %in% areas)
mp &lt;- ggplot(xi, aes(x = Year, y = NUE, color = Area)) + 
  geom_line() + 
  facet_wrap(Area~.) +
  theme_agData(legend.position = &quot;none&quot;) +
  labs(caption = &quot;\xa9 www.dblogr.com/  |  Data: FAOSTAT&quot;)
ggsave(&quot;nue_02.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_02.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="plotting-function" class="section level1">
<h1>Plotting function</h1>
<pre class="r"><code>ggNUE &lt;- function(area) {
  xi &lt;- xx %&gt;% filter(Area == area) %&gt;% arrange(Year)
  mp1 &lt;- ggplot(xi, aes(x = Year, y = N_per_h)) + 
    geom_line() + theme_agData() + labs(x = NULL, title = area) +
    scale_x_continuous(breaks = c(1970,1990,2010))
  mp2 &lt;- ggplot(xi, aes(x = Year, y = Yield)) + 
    geom_line() + theme_agData() + labs(x = NULL) +
    scale_x_continuous(breaks = c(1970,1990,2010))
  mp3 &lt;- ggplot(xi, aes(x = Year, y = NUE)) + 
    geom_line() + theme_agData() + labs(x = NULL) +
    scale_x_continuous(breaks = c(1970,1990,2010)) +
    scale_x_continuous(breaks = c(1970,1990,2010))
  mp4 &lt;- ggplot(xi, aes(x = N_per_h, y = Yield)) + 
    geom_point() + theme_agData() + geom_smooth(method = &quot;lm&quot;)
  mp5 &lt;- ggplot(xi, aes(x = N_per_h, y = NUE, label = Year)) + 
    geom_path() + geom_point(aes(color = Year)) +
    geom_label_repel(data = xi %&gt;% filter(Year %in% c(1961, 2017))) +
    theme_agData(legend.position = &quot;none&quot;) +
    labs(caption = &quot;\xa9 www.dblogr.com/  |  Data: FAOSTAT&quot;)
  mp1 &lt;- ggarrange(mp1, mp2, mp3, ncol = 3, align = &quot;h&quot;) 
  mp2 &lt;- ggarrange(mp4, mp5, ncol = 2, align = &quot;h&quot;) 
  ggarrange(mp1, mp2, nrow = 2)
}</code></pre>
</div>
<div id="australia" class="section level1">
<h1>Australia</h1>
<pre class="r"><code>mp &lt;- ggNUE(&quot;Australia&quot;)
ggsave(&quot;nue_03_australia.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_03_australia.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="canada" class="section level1">
<h1>Canada</h1>
<pre class="r"><code>mp &lt;- ggNUE(&quot;Canada&quot;)
ggsave(&quot;nue_04_canada.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_04_canada.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="china" class="section level1">
<h1>China</h1>
<pre class="r"><code>mp &lt;- ggNUE(&quot;China&quot;)
ggsave(&quot;nue_05_china.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_05_china.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="germany" class="section level1">
<h1>Germany</h1>
<pre class="r"><code>mp &lt;- ggNUE(&quot;Germany&quot;)
ggsave(&quot;nue_06_germany.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_06_germany.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="india" class="section level1">
<h1>India</h1>
<pre class="r"><code>mp &lt;- ggNUE(&quot;India&quot;)
ggsave(&quot;nue_07_india.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_07_india.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="france" class="section level1">
<h1>France</h1>
<pre class="r"><code>mp &lt;- ggNUE(&quot;France&quot;)
ggsave(&quot;nue_08_france.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="nue_08_france.png" /></p>
</div>
