---
title: "Economics of Canada"
subtitle: "GDP data among Canadian provinces from 2007-2018"
summary:  "GDP data among Canadian provinces from 2007-2018"
author: "Derek Michael Wright"
date: "2020-03-01"
categories: [ "dblogr" ]
tags: [ "Featured", "Economics", "R" ]
image:
  preview_only: true
links: 
  - icon_pack: fas
    icon: chart-line
    name: All Graphs
    url: dblogr_graphs/economics_of_canada
  - icon: file-code
    icon_pack: far
    name: HTML
    url: https://derekmichaelwright.github.io/htmls/dblogr/economics_of_canada.html
  - icon: file-pdf
    icon_pack: far
    name: PDF (Save/Print)
    url: dblogr_pdfs/economics_of_canada.pdf
---



<hr />
<pre class="r"><code># devtools::install_github(&quot;derekmichaelwright/dblogr&quot;)
library(dblogr) # Loads: tidyverse, ggpubr, ggbeeswarm, ggrepel</code></pre>
<div id="prepare-data" class="section level1">
<h1>Prepare Data</h1>
<p>STATCAN data Tables: 36-10-0400-01, 36-10-0402-01, 17-10-0009-01</p>
<pre class="r"><code># GDP by province
d1 &lt;- dblogr_STATCAN_GDP_Total
# GDP percent by industry
d2 &lt;- dblogr_STATCAN_GDP_Industry
# Population by province
d3 &lt;- dblogr_STATCAN_Population_Q %&gt;% 
  group_by(Area, Year) %&gt;% 
  summarise(Number = round(mean(Number, na.rm = F))) %&gt;% 
  ungroup()</code></pre>
<div style="page-break-after: always;"></div>
</div>
<div id="gdp" class="section level1">
<h1>GDP</h1>
<pre class="r"><code># Prep data
xx &lt;- d1 %&gt;% filter(!is.na(`Current dollars`)) %&gt;%
  mutate(`Current dollars` = `Current dollars` / 1000000)
x2 &lt;- xx %&gt;% filter(Year == 2016) %&gt;%
  arrange(desc(`Current dollars`)) %&gt;% 
  mutate(Area = factor(Area, levels = unique(Area)))
# Plot
mp &lt;- ggplot(x2, aes(x = Area, y = `Current dollars`, fill = Area)) + 
  geom_bar(stat = &quot;identity&quot;, color = &quot;black&quot;) +
  theme_dblogr(legend.position = &quot;none&quot;,
        axis.text.x = element_text(angle = 90, vjust = 0.4, hjust = 1)) +
  labs(title = &quot;GDP by Province (2016)&quot;, y = &quot;Current Dollars (Million)&quot;,
       caption = &quot;\xa9 www.dblogr.com/  |  Data: STATCAN&quot;)
ggsave(&quot;economics_of_canada_01.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="economics_of_canada_01.png" /></p>
<pre class="r"><code># Plot
mp &lt;- ggplot(xx, aes(x = Year, y = `Current dollars`, color = Area)) + 
  geom_line() +
  coord_cartesian(xlim = c(1997.75, 2015.25)) +
  scale_y_continuous(sec.axis = sec_axis(~ ., breaks = x2$`Current dollars`, labels = x2$Area)) +
  theme_dblogr(legend.position = &quot;none&quot;) +
  labs(title = &quot;GDP by Province&quot;, y = &quot;Current Dollars (Million)&quot;,
       caption = &quot;\xa9 www.dblogr.com/  |  Data: STATCAN&quot;)
ggsave(&quot;economics_of_canada_02.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="economics_of_canada_02.png" /></p>
<pre class="r"><code># Plot
mp &lt;- mp + facet_wrap(Area~., scale = &quot;free_y&quot;, ncol = 5) + 
  scale_y_continuous()
ggsave(&quot;economics_of_canada_03.png&quot;, mp, width = 10, height = 4)</code></pre>
<p><img src="economics_of_canada_03.png" /></p>
<div style="page-break-after: always;"></div>
<pre class="r"><code># Prep data
wc &lt;- c(&quot;British Columbia&quot;, &quot;Alberta&quot;, &quot;Saskatchewan&quot;, &quot;Manitoba&quot;,
        &quot;Yukon&quot;, &quot;Northwest Territories&quot;, &quot;Nunavut&quot;)
xx &lt;- xx %&gt;% filter(!is.na(`Current dollars`)) %&gt;%
  mutate(Region = ifelse(Area %in% wc, &quot;Western Canada&quot;, &quot;Eastern Canada&quot;)) %&gt;%
  group_by(Region, Year) %&gt;% 
  summarise(`Current dollars` = sum(`Current dollars`))
# Plot
mp &lt;- ggplot(xx, aes(x = Year, y = `Current dollars`, color = Region)) + 
  geom_line() + geom_point() +
  coord_cartesian(xlim = c(1997.75, 2015.25)) +
  theme_dblogr(legend.position = &quot;bottom&quot;) +
  labs(y = &quot;Current Dollars (Million)&quot;,
       caption = &quot;\xa9 www.dblogr.com/  |  Data: STATCAN&quot;)
ggsave(&quot;economics_of_canada_04.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="economics_of_canada_04.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="gdp-per-person" class="section level1">
<h1>GDP Per Person</h1>
<pre class="r"><code># Prep data
xx &lt;- d1 %&gt;% left_join(d3, by = c(&quot;Area&quot;, &quot;Year&quot;)) %&gt;%
  mutate(GDP_PP = `Current dollars` / Number) %&gt;%
  filter(!is.na(GDP_PP))
x2 &lt;- xx %&gt;% filter(Year == 2016) %&gt;%
  arrange(desc(GDP_PP)) %&gt;% 
  mutate(Area = factor(Area, levels = unique(Area)))
# Plot
mp &lt;- ggplot(x2, aes(x = Area, y = GDP_PP, fill = Area)) + 
  geom_bar(stat = &quot;identity&quot;, color = &quot;black&quot;) +
  theme_dblogr(legend.position = &quot;none&quot;,
        axis.text.x = element_text(angle = 90, vjust = 0.4, hjust = 1)) +
  labs(title = &quot;GDP by Province (2016)&quot;, y = &quot;Current Dollars (Million)&quot;,
       caption = &quot;\xa9 www.dblogr.com/  |  Data: STATCAN&quot;)
ggsave(&quot;economics_of_canada_05.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="economics_of_canada_05.png" /></p>
<pre class="r"><code>mp &lt;- ggplot(xx, aes(x = Year, y = GDP_PP, color = Area)) + 
  geom_line() +
  coord_cartesian(xlim = c(1999.5, 2015.5)) +
  scale_y_continuous(sec.axis = sec_axis(~ ., breaks = x2$GDP_PP, labels = x2$Area)) +
  theme_dblogr(legend.position = &quot;none&quot;) +
  labs(title = &quot;GDP Per Person&quot;, y = &quot;Million Dollars&quot;,
       caption = &quot;\xa9 www.dblogr.com/  |  Data: STATCAN&quot;)
ggsave(&quot;economics_of_canada_06.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="economics_of_canada_06.png" /></p>
<pre class="r"><code>mp &lt;- mp + facet_wrap(Area~., ncol = 5) + 
  scale_y_continuous()
ggsave(&quot;economics_of_canada_07.png&quot;, mp, width = 10, height = 4)</code></pre>
<p><img src="economics_of_canada_07.png" /></p>
<div style="page-break-after: always;"></div>
<pre class="r"><code># Prep data
wc &lt;- c(&quot;British Columbia&quot;, &quot;Alberta&quot;, &quot;Saskatchewan&quot;, &quot;Manitoba&quot;,
        &quot;Yukon&quot;, &quot;Northwest Territories&quot;, &quot;Nunavut&quot;)
xx &lt;- xx %&gt;% filter(!is.na(`Current dollars`)) %&gt;%
  mutate(Region = ifelse(Area %in% wc, &quot;Western Canada&quot;, &quot;Eastern Canada&quot;)) %&gt;%
  group_by(Region, Year) %&gt;% 
  summarise(GDP_PP = sum(GDP_PP))
# Plot
mp &lt;- ggplot(xx, aes(x = Year, y = GDP_PP, color = Region)) + 
  geom_line() + geom_point() +
  theme_dblogr(legend.position = &quot;bottom&quot;) +
  labs(y = &quot;GDP Per Person&quot;,
       caption = &quot;\xa9 www.dblogr.com/  |  Data: STATCAN&quot;)
ggsave(&quot;economics_of_canada_08.png&quot;, mp, width = 6, height = 4)</code></pre>
<p><img src="economics_of_canada_08.png" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="compare-privinces" class="section level1">
<h1>Compare Privinces</h1>
<pre class="r"><code>ggGDP_PP &lt;- function(year, areas) {
  # Prep data
  xx &lt;- d2 %&gt;% select(1:3, 9:ncol(.)) %&gt;% 
    filter(Year == year, Area %in% areas) %&gt;%
    gather(Industry, Value, 4:ncol(.)) %&gt;%
    left_join(d3, by = c(&quot;Area&quot;, &quot;Year&quot;)) %&gt;%
    mutate(GDP_PP = Value / Number) %&gt;%
    filter(!is.na(GDP_PP))
  levs &lt;- xx %&gt;% filter(Year == year, Area == areas[1]) %&gt;% 
    arrange(Value) %&gt;% pull(Industry)
  xx &lt;- xx %&gt;% 
    mutate(Industry = factor(Industry, levels = levs),
           Area = factor(Area, levels = areas))
  # Plot
  ggplot(xx, aes(x = Area, y = GDP_PP, fill = Area)) +
    geom_bar(stat = &quot;identity&quot;) +
    theme_dblogr(legend.position = &quot;bottom&quot;, linesize = 0.1,
                 axis.text.x = element_blank(),
                 axis.ticks.x = element_blank()) +
    facet_grid(.~Industry, labeller = label_wrap_gen(width = 15)) +
    labs(title =&quot;GDP Per Person 2016&quot;, y = &quot;Million $ / Person&quot;, x = NULL,
         caption = &quot;\xa9 www.dblogr.com/  |  Data: STATCAN&quot;)
}</code></pre>
<pre class="r"><code>mp &lt;- ggGDP_PP(2016, c(&quot;Alberta&quot;, &quot;Quebec&quot;))
ggsave(&quot;economics_of_canada_09.png&quot;, mp, width = 25, height = 8)</code></pre>
<p><img src="economics_of_canada_09.png" /></p>
<pre class="r"><code>mp &lt;- ggGDP_PP(2016, c(&quot;Alberta&quot;, &quot;Ontario&quot;))
ggsave(&quot;economics_of_canada_10.png&quot;, mp, width = 25, height = 8)</code></pre>
<p><img src="economics_of_canada_10.png" /></p>
<pre class="r"><code>mp &lt;- ggGDP_PP(2016, c(&quot;Alberta&quot;, &quot;British Columbia&quot;))
ggsave(&quot;economics_of_canada_11.png&quot;, mp, width = 25, height = 8)</code></pre>
<p><img src="economics_of_canada_11.png" /></p>
<pre class="r"><code>mp &lt;- ggGDP_PP(2016, c(&quot;Saskatchewan&quot;, &quot;Manitoba&quot;))
ggsave(&quot;economics_of_canada_12.png&quot;, mp, width = 25, height = 8)</code></pre>
<p><img src="economics_of_canada_12.png" /></p>
</div>
